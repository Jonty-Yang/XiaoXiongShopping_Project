# 一、SpringBoot + Vue 项目

### 项目描述

这是一个博客后台管理系统，有多个用户角色，不同的角色有不同权限，如管理员可以对博客内容 ，文章类别以及文章标签等
进行增删改查操作，普通用户只能够对自己发布的博客进行操作，前台页面功能包括发表文章 ，评论文章，文章归档等多个模块

### 我在这个项目中主要负责的是

1.工程的整体设计数据库表权限模块的设计
2.实现了该项目中的基于权限的动态菜单功能，不同的用户登录有不同的菜单，实现了基于Securty+jwt的鉴权授权模块。

#### 1.1 问： 你的权限模块是怎么设计的?

用户表  角色表 权限表 菜单表
用户_角色中间表  角色_权限中间表  权限_菜单中间表

#### 1.1 问：你如何使用Security实现鉴权和授权的?

在项目中使用Security框架实现了登录认证及配合JWT完成凭证的颁发，用户在登录时，接口会先校验用户输入的用户名
和密码，然后使用JWT为用户颁发对应的凭证，同时我在后端还设计了统一校验用户凭证的过滤器，在过滤器会校验凭证，
并将用户信息存入上下文保存到全局

#### 1.2 问：你是如何实现动态菜单的?

在前端设计了一个全局路由守卫，每当路由发生变化的时候都会进入到路由守卫的方法中，如果路由当前是需要菜单数据的，
则向后端发起请求获取当前用户所拥有的菜单权限数据，并响应给路由守卫，路由守卫通过require函数将组件和路由进行
动态绑定从而实现动态菜单动态路由。

# 二、SpringCloud alibaba 电子商城项目

### 项目描述

这是一个分布式的电子商务平台，该系统使用了SpringCloud alibaba体系下的组件来运维各个服务，
如nacos注册中心，gateway分布式网关，hystrix熔断降级，openFeign 接口式调用和 Seata分布式事务等，
还使用了非关系型数据库redis来实现缓存功能

### 我在这个项目中负责的是：

1. 鉴权授权微服务的开发，使用 JWT(RSA 非对称算法)生成token 并颁发凭证。
2. 网关微服务gateway的开发，同时使用nacos配合gateway实现了动态路由功能，路由信息都配置在nacos中，
每次修改nacos中的配置都可以即时更新到gateway中，无需重启服务。
3. 商品微服务的开发，如简单商品信息查询，同时配合redis将未从redis中载入的数据重新缓存，同时还实现了
商品模块的异步入库功能，这里用到了Spring的Async注解
4. 订单微服务的开发，这里使用了OpenFein远程调用了其他服务，例如调用账户微服务，商品微服务等服务获取
信息数据，同时使用Seata实现了分布式事务，保证事务的一致性

#### 2.1 问：你简单介绍一下这个动态路由是怎么实现的?

如果把路由都配置在yml中，因为服务比较多，所以不容易管理，而且配置文件一旦更改，还需要重启服务器。所以我把
路由的配置都存到了nacos中，在nacos中保存和管理路由配置，通过nacos client提供的ConfigService实现了
这个功能，主要是使用ConfigService读取配置信息，并且给它添加了一个监听，每当有人修改网关配置的时候，
ConfigService都会监听到修改事件，并且重新获取路由配置，针对路由配置信息在程序中把它重新包装成
routeDefinition对象并加入到gateway中，通过事件刷新gateway的路由配置

#### 2.2 问：鉴权授权中心模块你是怎么实现的?

答： 鉴权授权中心主要有2个业务方法，一个登录一个注册，登录方法会根据用户名密码校验用户是否存在，然后使用
jwts的工具类使用RSA非对称加密算法生成token字符串响应给客户端，注册是通过接收用户输入的用户信息。持久化
后同样通过工具类生成token令牌响应客户端，生成的令牌最终客户端在提交的时候会由网关服务的过滤器完成校验

#### 2.3 问：网关的过滤功能有哪些，你这个网关主要有哪些业务?

答： 网关中主要有2个全局过滤器,因为是一个微服务项目，所有的请求都需要经过网关程序，登录和注册请求也是一样，
在处理这个问题的时候思考过是转发还是远程调用比较合适，后来还是选择了远程调用，但是因为Gateway底层使用的
webflux导致在过滤器中一旦消费掉Request中的body，后续过滤器就无法在获取body信息了，所以在这里做了一个
全局过滤器用来缓存body中的数据，后面需要使用body的过滤器自己订阅获取body信息，body解析完毕后在通过
restTemplate发起远程调用，调用鉴权授权中心的登录注册方法实现功能。局部过滤器主要是对请求中携带的令牌
token进行校验，一旦token无误则放行请求

#### 2.4 问：你在这个项目中有什么时候，遇到过什么难解决的问题吗?

Gateway使用的是webflux的api，之前只使用过spring的webmvc，对webflux不太熟练，查了很多资料，现在也
不是特别清晰，还在学习中。因为在设计网关过滤器的时候没有选择将请求转发给授权和鉴权中心，而是在gateway内部
完成对登录和注册方法的远程调用，而基于webflux的filter在消费掉body之后后续的filter无法获取body，所以
就必须得先把请求的body缓存起来，我在这里就自己实现了一个过滤器链，一个过滤器负责缓存body，一个过滤器负责
将body中的请求数据提取出来发送给授权鉴权中心完成登录，在实现缓存的body的时候，使用了DataBufferUtils，
将body中的数据提取出来存入数据缓冲区，并且要保证数据不被释放，这里调用了DataBufferUtils的retain方法，
然后在登录注册过滤器中，订阅刚才存入的body数据，获取数据后再将缓冲区释放，然后通过rest向授权鉴权中心发送
请求获取token


#### 2.5 问：为什么你要缓存请求body

因为在过滤器中要对请求头进行鉴权，我当时想的是干脆就直接把登录和注册也放到这个过滤器一并实现好了，直接在
过滤器完成远程调用并且返回凭证，在做的过程中发现一旦消费掉请求中的body，后续的服务和过滤器就无法获取
body数据了，就需要对body数据进行缓存。

#### 2.6 问：在你的项目中Nacos起什么作用

Nacos除了管理配置以外，还提供了服务之间的注册与发现功能，各服务在启动时候将自身的IP 端口等实例信息注册
到Nacos中，其他服务就可以通过Nacos的客户端对象去获取其他服务的IP端口等实例信息，从而实现服务与服务之间
的互相访问没有IP或端口的耦合，还可以配合例如Ribbon实现负载均衡。

#### 2.7 问：在你的项目中Gateway起什么作用

隔离客户端与服务器端，可以实现请求转发, 限流，负载均衡，权限控制等等功能

#### 2.8 问：openFein有什么作用

OpenFeign是声明式的web服务客户端也可以叫做声明式的REST客户端，它让编写Web服务客户端变得简单

客户端   ||Gateway||   服务器端

服务客户端   ||Fegin||   服务 服务器

# 三、Spring + SpringMVC + Mybatis + 角西财经

### 3.1	

####  









